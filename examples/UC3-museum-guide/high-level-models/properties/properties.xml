<?xml version="1.1" encoding="UTF-8" ?>
<properties>
  <ports>
    <!-- NOTE: Each ROS communication protocol gives rise to a type of port -->
    <!-- NOTE: Each element inside a port defines a new state or event variable -->
    <ros_topic topic="/BatteryComponent/battery_level" type="std_msgs/Int32">
      <!-- Battery level -->
      <!-- NOTE: State variables need a default value to be initialized when the system starts. Each successive communication updates their value. -->
      <state_var id="battery_level" type="int32" field="data" expr="100"/>
      <!-- Battery level published (event) -->
      <!-- NOTE: Event variables are Boolean variables that are only true in the instant the communication happens, false otherwise. -->
      <event_var id="battery_level_published"/>
    </ros_topic>

    <!-- NOTE: Service ports must specify if they are for the request or respond event -->
    <ros_service service_name="/NotifyUserComponent/StartAlarm" type="notify_user_interfaces_dummy/StartAlarm" event="request">
      <!-- Alarm (event) -->
      <event_var id="alarm"/>
    </ros_service>

  </ports>

  <!-- NOTE: Property specification patterns as in [ps-patterns.wikidot.com] -->
  <guarantees>
    <property id="battery_alarm_response_1" pattern="precedence">
      <events>
        <event>alarm</event>
        <event>battery_level &lt;= 30</event>
      </events>
      <scope type="globally"/>
    </property>

    <property id="battery_alarm_response_2" pattern="response">
      <events>
        <event>battery_level &lt;= 30</event>
        <event>alarm</event>
      </events>
      <scope type="globally"/>
      <time_interval from="0" to="6200" time_unit="ms"/>
    </property>

    <property id="no_alarm_if_battery_high" pattern="absence">
      <event>alarm</event>
      <scope type="before" event="battery_level &lt;= 30"/>
    </property>

    <property id="battery_recurrence" pattern="recurrence">
      <event>battery_level_published</event>
      <scope type="globally"/>
      <time_interval interval="3" time_unit="s"/>
    </property>

    <property id="battery_steady" pattern="constrained precedence chain" causes="N" effects="1">
      <events>
        <event>alarm</event>
        <event>battery_level &lt;= 20</event>
        <chain>
          <event>battery_level &lt;= 30</event>
          <event>battery_level &lt;= 40</event>
        </chain>
        <chain>
          <event>battery_level &gt;= 21</event>
          <event>battery_level &gt;= 31</event>
          <event>battery_level &gt;= 41</event>
        </chain>
      </events>
      <scope type="globally"/>
    </property>
  </guarantees>

  <assumes>
    <!-- NOTE: Same format as guarantees -->
    <!-- <property ... /> -->
  </assumes>
</properties>